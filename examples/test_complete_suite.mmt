########################################
#  MAMMUTH v3.6 - COMPLETE TEST SUITE
########################################

echo "========================================"
echo "  MAMMUTH v3.6 - COMPLETE TEST SUITE"
echo "========================================"
echo ""

#==========================================
# 1. TYPE SYSTEM & VARIABLES
#==========================================
echo "=== 1. TYPE SYSTEM & VARIABLES ==="

int x = 42
double pi = 3.14
string text = "Hello"
int counter = 100
fixed int constant = 999

echo "int: " $ str(x)
echo "double: " $ str(pi)
echo "string: " $ text
echo "mutable int: " $ str(counter)
echo "fixed: " $ str(constant)
echo ""

#==========================================
# 2. ARITHMETIC OPERATORS
#==========================================
echo "=== 2. ARITHMETIC OPERATORS ==="

int a = 10
int b = 3

echo "10 + 3 = " $ str(a + b)
echo "10 - 3 = " $ str(a - b)
echo "10 * 3 = " $ str(a * b)
echo "10 / 3 = " $ str(a / b)
echo "10 % 3 = " $ str(a % b)
echo "2 ** 3 = " $ str(2 ** 3)

double d1 = 5.5
double d2 = 2.0
echo "5.5 + 2.0 = " $ str(d1 + d2)
echo "5.5 * 2.0 = " $ str(d1 * d2)
echo ""

#==========================================
# 3. COMPARISON & LOGICAL
#==========================================
echo "=== 3. COMPARISON & LOGICAL ==="

echo "5 < 10: " $ str(5 < 10)
echo "5 <= 5: " $ str(5 <= 5)
echo "10 > 5: " $ str(10 > 5)
echo "10 >= 10: " $ str(10 >= 10)
echo "5 == 5: " $ str(5 == 5)
echo "5 != 10: " $ str(5 != 10)

echo "1 and 1: " $ str(1 and 1)
echo "1 and 0: " $ str(1 and 0)
echo "0 or 1: " $ str(0 or 1)
echo "!1: " $ str(!1)
echo "!0: " $ str(!0)
echo ""

#==========================================
# 4. OPERATOR $ (Composition)
#==========================================
echo "=== 4. OPERATOR $ (Composition) ==="

string s1 = "Hello"
string s2 = " World"
echo s1 $ s2

int arr1[] = 1, 2, 3
int arr2[] = 4, 5, 6
int combined[] = arr1 $ arr2
echo "Array: " $ str(combined[0]) $ ", " $ str(combined[5])
echo ""

#==========================================
# 5. IF/ELIF/ELSE
#==========================================
echo "=== 5. IF/ELIF/ELSE ==="

int val = 15

int result = if val > 50:: 200 else:: 100
echo "Inline if: " $ str(result)

if val < 10::
    echo "val less than 10"
elif val >= 11 and val <= 20::
    echo "val between 11-20"
else::
    echo "val > 20"
end

if val >= 1 and val <= 99::
    echo "val in range 1-99"
end
echo ""

#==========================================
# 6. LOOPS
#==========================================
echo "=== 6. LOOPS ==="

int i = 0
while (i < 3)::
    echo "while i=" $ str(i)
    i = i + 1
end

int items[] = 0, 1, 2
for item in items::
    echo "for-in: " $ str(item)
end
echo ""

#==========================================
# 7. ARRAYS
#==========================================
echo "=== 7. ARRAYS ==="

int arr[] = 1, 2, 3, 4, 5

echo "arr[0]: " $ str(arr[0])
echo "arr[4]: " $ str(arr[4])
echo "arr[-1]: " $ str(arr[-1])

int slice[] = arr[1..3]
echo "arr[1..3]: " $ str(slice[0]) $ ", " $ str(slice[2])

int slice2[] = arr[2..]
echo "arr[2..]: length=" $ str(len(slice2))

dynamic int darr[] = 10, 20, 30
darr[0] = 99
echo "dynamic arr[0]: " $ str(darr[0])

echo "len(arr): " $ str(len(arr))
echo "array_first: " $ str(array_first(arr))
echo "array_last: " $ str(array_last(arr))
echo ""

#==========================================
# 8. STRINGS
#==========================================
echo "=== 8. STRINGS ==="

string str1 = "Mammuth"
echo "String: " $ str1
echo "len: " $ str(len(str1))
echo "text[0]: " $ str1[0]
echo "text[1..3]: " $ str1[1..3]

string msg = "Hello" $ " " $ "World"
echo msg

echo str(str1 == "Mammuth")
echo ""

#==========================================
# 9. FUNCTIONS
#==========================================
echo "=== 9. FUNCTIONS ==="

def doubleValue(n: int) -> int::
    n * 2
end

echo "doubleValue(5): " $ str(doubleValue(5))

def add(a: int, b: int) -> int::
    a + b
end

echo "add(3, 7): " $ str(add(3, 7))

def makeAdder(x: int) -> <(int)>::
    def inner(y: int) -> int::
        x + y
    end
    inner
end

<(int)> addFive = makeAdder(5)
echo "addFive(10): " $ str(addFive(10))
echo ""

#==========================================
# 10. CLOSURES (Read-Only)
#==========================================
echo "=== 10. CLOSURES (Read-Only) ==="

# Closures in Mammuth possono LEGGERE variabili catturate
# ma NON modificarle (funzioni pure!)

def makeMultiplier(factor: int) -> <(int)>::
    def multiply(n: int) -> int::
        n * factor  # Legge factor (OK!)
    end
    multiply
end

<(int)> triple = makeMultiplier(3)
echo "triple(5): " $ str(triple(5))

<(int)> quadruple = makeMultiplier(4)  
echo "quadruple(5): " $ str(quadruple(5))

echo ""

#==========================================
# 11. FUNCTION COMPOSITION
#==========================================
echo "=== 11. FUNCTION COMPOSITION ==="

def addOne(n: int) -> int:: n + 1 end
def multiplyTwo(n: int) -> int:: n * 2 end

<(int)> composed = addOne $ multiplyTwo
echo "composed(5): " $ str(composed(5))
echo ""

#==========================================
# 12. IF AS EXPRESSION
#==========================================
echo "=== 12. IF AS EXPRESSION ==="

def abs(n: int) -> int::
    if n < 0:: n * -1 else:: n
end

echo "abs(-5): " $ str(abs(-5))
echo "abs(5): " $ str(abs(5))

<(int)> func = if 1 == 1:: addOne else:: multiplyTwo
echo "func(10): " $ str(func(10))
echo ""

#==========================================
# 13. CONDCHAIN (??)
#==========================================
echo "=== 13. CONDCHAIN (??) ==="

int score = 75
int grade = score >= 90 ? 5 ?? score >= 80 ? 4 ?? score >= 70 ? 3 ?? score >= 60 ? 2 : 1

echo "grade for 75: " $ str(grade)
echo ""

#==========================================
# 14. FILTER (=>)
#==========================================
echo "=== 14. FILTER (=>) ==="

int numbers[] = 1, 2, 3, 4, 5, 6, 7, 8, 9, 10

int evens[] = numbers => x % 2 == 0
echo "evens: " $ str(len(evens)) $ " elementi"
echo "first even: " $ str(evens[0])

int big[] = numbers => x > 5
echo "numbers > 5: " $ str(len(big))

int range[] = numbers => x >= 4 and x <= 7
echo "range [4-7]: " $ str(len(range))

int evenAndBig[] = numbers => x % 2 == 0 => x > 4
echo "even AND >4: " $ str(len(evenAndBig))
echo "first: " $ str(evenAndBig[0])
echo ""

#==========================================
# 15. RANDOM FUNCTIONS
#==========================================
echo "=== 15. RANDOM FUNCTIONS ==="

int dice1 = randInt(1, 7)
int dice2 = randInt(1, 7)
echo "dice1: " $ str(dice1)
echo "dice2: " $ str(dice2)
echo "total: " $ str(dice1 + dice2)

int coin = randInt(0, 2)
echo "coin flip: " $ str(coin)
echo ""

#==========================================
# 16. BUILTIN FUNCTIONS
#==========================================
echo "=== 16. BUILTIN FUNCTIONS ==="

string numstr = "123"
echo "toInt('123'): " $ str(toInt(numstr))

int num = 42
echo "toDouble(42): " $ str(toDouble(num))

echo "typeOf(42): " $ typeOf(42)
echo "typeOf(3.14): " $ typeOf(3.14)
echo "typeOf('hi'): " $ typeOf("hi")

int r1[] = range(5)
echo "range(5): " $ str(len(r1))

int r2[] = range(3, 7)
echo "range(3,7): " $ str(len(r2))
echo ""

#==========================================
# 17. NESTED FUNCTIONS
#==========================================
echo "=== 17. NESTED FUNCTIONS ==="

def outer(x: int) -> int::
    def inner(y: int) -> int::
        x * y
    end
    inner(x + 2) + 10
end

echo "outer(5): " $ str(outer(5))
echo ""

#==========================================
# 18. COMMENTS
#==========================================
echo "=== 18. COMMENTS ==="

# This is a single line comment
echo "Single line comment works"

#[
This is a 
multi-line comment
that spans multiple lines
]#
echo "Multi-line comment works"
echo ""

#==========================================
# 19. LAMBDA EXPRESSIONS
#==========================================
echo "=== 19. LAMBDA EXPRESSIONS ==="

<(int)> triple = def(n: int) -> int:: n * 3 end
echo "triple(7): " $ str(triple(7))

<(int)> addBase = def(n: int) -> int:: n + 10 end
echo "addBase(5): " $ str(addBase(5))
echo ""

#==========================================
# 20. COMPLEX EXPRESSIONS
#==========================================
echo "=== 20. COMPLEX EXPRESSIONS ==="

int complex = (10 + 5) * (20 / 4) - 10 + (2 ** 3)
echo "complex math: " $ str(complex)

int filtered[] = numbers => x % 2 == 0
int sliced[] = filtered[0..1]
echo "filtered & sliced: " $ str(sliced[0])

string status = if complex > 10:: "HIGH" else:: "LOW"
echo "conditional: " $ status
echo ""

#==========================================
# 21. EDGE CASES
#==========================================
echo "=== 21. EDGE CASES ==="

int empty[] = numbers => x > 100
echo "empty filter: " $ str(len(empty))

int single[] = 42
echo "single element: " $ str(single[0])

int test[] = 10, 20, 30
echo "test[-1]: " $ str(test[-1])
echo "test[-2]: " $ str(test[-2])

int boolResult = 5 > 3
echo "boolean result: " $ str(boolResult)
echo ""

#==========================================
# FINAL SUMMARY
#==========================================
echo "========================================"
echo "  TEST SUITE COMPLETE!"
echo "========================================"
echo ""
echo "Features tested:"
echo "  1. Type system (int, double, string)"
echo "  2. Variables (normal, dynamic, fixed)"
echo "  3. Arithmetic operators (+,-,*,/,%,**)"
echo "  4. Comparison operators (<,<=,>,>=,==,!=)"
echo "  5. Logical operators (and, or, !)"
echo "  6. Universal $ operator"
echo "  7. If/elif/else (inline & multiline)"
echo "  8. While loops"
echo "  9. For-in loops"
echo " 10. Arrays (access, slice, dynamic)"
echo " 11. Strings (operations, slicing)"
echo " 12. Functions (def, params, return)"
echo " 13. Closures"
echo " 14. Function composition"
echo " 15. Lambda expressions"
echo " 16. Nested functions"
echo " 17. First-class functions"
echo " 18. CondChain (??)"
echo " 19. Filter (=>)"
echo " 20. Random functions"
echo " 21. Builtin functions"
echo " 22. Comments (# and #[ ]#)"
echo " 23. Complex expressions"
echo " 24. Edge cases"
echo ""
echo "Mammuth v3.6 - ALL FEATURES WORKING!"
echo "========================================"
